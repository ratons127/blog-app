<%- include('../partials/header') %>
<article class="post-detail">
  <h1><%= post.title %></h1>
  <% if (post.imageUrl) { %>
    <img src="<%= post.imageUrl %>" alt="Post image" class="post-image" />
  <% } %>
  <p class="meta">By <%= post.author.username %></p>
  <div class="content"><%= post.content %></div>
</article>

<section class="comments">
  <h2>Comments</h2>
  <form id="comment-form" class="comment-form">
    <div class="comment-row">
      <input type="text" name="guestName" placeholder="Your name (required for guests)" />
      <input type="email" name="guestEmail" placeholder="Email (optional)" />
    </div>
    <textarea name="content" rows="3" placeholder="Write a comment..." required></textarea>
    <button type="submit">Post comment</button>
    <p id="comment-message"></p>
  </form>
  <% if (comments.length === 0) { %>
    <p>No comments yet.</p>
  <% } %>
  <% comments.forEach(comment => { %>
    <div class="comment">
      <strong><%= comment.author ? comment.author.username : comment.guestName %></strong>
      <p><%= comment.content %></p>
    </div>
  <% }) %>
</section>
<script src="/js/comment-form.js"></script>
<%- include('../partials/footer') %>
